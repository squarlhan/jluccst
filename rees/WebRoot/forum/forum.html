<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta http-equiv="refresh" content="3600"><!--多少秒钟后刷新本页-->
<title>讨论区</title>
<script language="javascript">
/*以下为功能模块脚本，允许调整界面时适当修改*/
function validstr(str) // 验证用户名
{ var s,i,j; s=" +=|'#&<>%*`^/\\\";,."; str1=str.value.toString();
  if (str.value.length <1){alert("昵称不能为空！");str.focus(); return false;}
  for (i=0; i<str1.length; i++)
  {	for(j=0;j<s.length;j++)
	{if (str1.charAt(i) == s.charAt(j))
     {	alert("名字中不能包含特殊字符: +=|'#&<>%*`^/\\\";,.空格.");
 		str.focus(); return false;
  }}}return true;
}
function go(url){
	window.open(url,"","toolbar=no,location=no,directories=no,menubar=no,,scrollbars=no,resizable=no,width=250,height=150");
}
function OnLogin(n) // 登录聊天室
{	if(!validstr(login.user))return ;
	var Room = Server.GetRoomObject(n);
	if(Room.UserCount >= 100)	
	{	// 如果人数超过100，则建议用户打开包厢功能
		if(login.boxfunc.checked==false)
			if(true == confirm("该房间目前人数比较多，建议您启用包厢功能！\r\n选择“确定”系统将自动为您开启包厢功能!"))
				login.boxfunc.checked = true;
	}
	if(Room.State == -1)
	{	if(!confirm("该房间已经满员，只有系统管理员方可登录！\r\n选择“取消”按钮重新选择进入其它房间!"))
			return ;	
	}
	
	var strWindow = "iChatMain" ;
	var strPos = "toolbar=no,location=no,directories=no,menubar=no,resizable=yes" ;
	login.target = strWindow ;
	login.action =  Room.URL + "Login" ;

	var w = screen.width ;
	var h = screen.height ;
	/* 自动判断屏幕大小，并建议用户是否用全屏方式打开窗口
	if(w <= 800 && h <= 600 && login.fullscreen.checked == false)
		login.fullscreen.checked = confirm("系统建议您以全屏方式进入聊天室，您同意吗？") ;
	*/

	if(login.fullscreen.checked)
	{	var pwin = window.open("about:blank", strWindow, strPos+",top=0,left=0,width="+w+",height="+h) ;
		pwin.resizeTo(screen.availWidth, screen.availHeight) ;
	}else
		window.open("about:blank", strWindow, strPos) ;

	login.submit() ;
}
function OnUserList(n) // 查询在线用户列表
{	var Room = Server.GetRoomObject(n);
	window.open(Room.URL+"LookUser?r=" + Math.random(),"_lookuser","toolbar=no,location=no,directories=no,menubar=no,scrollbars=yes,resizable=yes,width=500,height=400");
}
function OnRegister() // 注册昵称 (GetRoomURL(0)的参数0可设置从那个房间内获取注册表单，建立选择一个人数少的房间让用户注册昵称)
{	if(Server.RoomsCount() > 0)
	window.open(Server.GetRoomObject(0).URL+"Register","_Register","toolbar=no,location=no,directories=no,menubar=no,scrollbars=no,resizable=yes,width=270,height=425"); 
	// 不含头像选择的注册窗口 Width = 320, Height = 510    含头像选择的注册窗口 Width = 320, Height = 510
}
function OnAllUsers() // 显示在线用户总列表
{	if(Server.RoomsCount() > 0)
	window.open(Server.GetRoomObject(0).URL+"AllUsers?r=" + Math.random(),"_AllUsers","toolbar=no,location=no,directories=no,menubar=no,scrollbars=yes,resizable=yes");
}
function OnFindUser() // 显示在线用户总列表
	{if(Server.RoomsCount() <= 0)	return;
	var strUserName = prompt("请输入您要查找的用户名?", "找谁?") ;
	if(strUserName == null || strUserName == "找谁?" || strUserName.length <1)	return ;
	window.open(Server.GetRoomObject(0).URL+"FindUser?user="+strUserName+"&r=" + Math.random(),"_FindUser","toolbar=no,location=no,directories=no,menubar=no,scrollbars=yes,resizable=yes");
}
function OnPrivate() // 打开自建聊天室窗口
{	if(Server.RoomsCount() > 0)
	window.open(Server.GetRoomObject(0).URL+"Private","_Private","toolbar=no,location=no,directories=no,menubar=no,scrollbars=yes,resizable=yes");
}
function OnUserGuide() // 打开功能说明窗口
{	if(Server.RoomsCount() > 0)
	window.open(Server.GetRoomObject(0).URL+"UserGuide","_UserGuide","toolbar=no,location=no,directories=no,menubar=no,scrollbars=yes,resizable=yes");
}
function OnClick(str)
{
	alert(str);
}

var Server = new ChatServer() ;
Server.Add("达人会馆","http://202.99.219.252:8883/",7,25,0,"不经意的岁月从我们身边划过,是否记的我们曾经封存的永久记忆?","admin","0",false,false);
Server.Add("邂逅浪漫","http://202.99.219.252:8884/",160,161,-1,"有缘千里来相会,无缘对面不相识.不经意的邂逅,浪漫的都市情怀...","admin","0",false,false);
Server.Add("清风夜语","http://202.99.219.252:8885/",68,99,0,"临风谁更飘香屑,醉拍阑干情味切.归时休放烛花红,待踏马蹄清夜月.","admin","0",false,false);
Server.Add("文苑茶社","http://202.99.219.252:8886/",5,86,0,"在龙城文苑品味美文，在茗香的茶社放飞思绪，欢迎各位雅士尽献文学魅力,一起探讨人生真谛...","admin","0",false,false);
Server.Add("“缘在工会”鹊桥交友","http://202.99.219.252:8887/",2,6,0,"太原市总工会“缘在工会”鹊桥交友聊天中心","yinxueguan","0",false,false);
Server.Add("外语沙龙","http://202.99.219.252:8888/",2,8,0,"英文聊天区，充分享受英文交流的乐趣。","admin","0",false,false);

</script>
<style type="text/css">
<!--
body {  font-size: 9pt}
table {  font-size: 9pt}
.c1 { font-size: 10.5pt}
a {  text-decoration: none; font-size: 9pt}
a:visited {  color: #0000FF; text-decoration: none; }
a:hover {  color: #FF0033; text-decoration: none; }
-->
</style>
</head><body language="JavaScript" target="iChatMain" bgcolor="#e4f9f0" leftmargin="0" topmargin="0">
<div align="center"> 
  <p>&nbsp;</p>
</div>
<form name="login" action="/Login" method="post">
  <table width="100%" border="0" align="center">
    <tbody><tr> 
      <td width="5%"> 
        <div align="center"><img src="images/biao_1.gif" width="37" height="38"></div>
      </td>
      <td width="7%"> 
        <div align="center"><a href="javascript:OnRegister();">注册昵称</a></div>
      </td>
      <td width="5%"> 
        <div align="center"><img src="images/biao_2.gif" width="37" height="38"></div>
      </td>
      <td width="7%"> 
        <div align="center"><a href="javascript:OnUserGuide();">功能说明</a></div>
      </td>
      <td width="5%"> 
        <div align="center"><img src="images/biao_3.gif" width="37" height="38"></div>
      </td>
      <td width="7%"> 
        <div align="center">聊天规则</div>
      </td>
      <td width="5%"> 
        <div align="center"><img src="images//biao_4.gif" width="37" height="38"></div>
      </td>
      <td width="7%"> 
        <div align="center"><a href="javascript:OnFindUser();">聊友查寻</a></div>
      </td>
      <td width="5%"> 
        <div align="center"><img src="images//biao_5.gif" width="37" height="38"></div>
      </td>
      <td width="7%"> 
        <div align="center"><a href="javascript:window.location.reload();">刷新列表</a></div>
      </td>
      <td width="5%"> 
        <div align="center"><img src="images//biao_7.gif" width="37" height="38"></div>
      </td>
      <td width="11%"> 
        <div align="center"><a href="javascript:OnAllUsers();">在线用户列表</a> 
          <!--
	[<a href="http://www.ichatok.com/shop/shop.asp" target="_blank">头像商店</a>]
	[<a href="http://www.ichatok.com/admin/top.asp" target="_blank">排行榜</a>]
	[<a href="javascript:go('http://www.ichatok.com/admin/password.htm')">找回密码</a>]
	[<a href="javascript:go('http://www.ichatok.com/admin/deleuser.htm')">帐号注销</a>]
	[<a href="http://www.ichatok.com/admin/login.htm" target="_blank">管理入口</a>]
-->
        </div>
      </td>
      <td width="5%"> 
        <div align="center"><img src="images//biao_6.gif" width="37" height="38"></div>
      </td>
      <td width="9%"> 
        <div align="center"><a href="javascript:window.external.AddFavorite('forum.html','讨论区')" target="_self">加入收藏夹</a></div>
      </td>
    </tr>
  </tbody></table>
  <a href="javascript:login.boxfunc.click();"></a><table cellspacing="0" cellpadding="2" width="95%" border="1" align="center" class="c1">
    <tbody><tr> 
      <td colspan="5" align="center"> 
    本系统开放[<font color="red"><script>document.write(Server.RoomsCount());</script>2</font>]个聊天室
	总在线人数[<font color="red"><script>document.write(Server.TotalUsers);</script>244</font>]人
	最高在线[<font color="red"><script>document.write(Server.MaxOnline);</script>275</font>]人
	注册用户[<font color="red"><script>document.write(Server.RegUsers);</script>683978
        </font>]人 <font color="FF3366" size="2">(游客登录无须密码)</font> </td>
  </tr>
  <tr align="center"> 
    <td width="40%">
		昵称:<input type="text" name="user" maxlength="12" size="10">
        密码:<input type="password" name="pass" maxlength="12" size="10">
    </td><td>
        性别:<input type="radio" name="radio1" onClick="login.xb.value=0;">女
        <input type="radio" name="radio1" onClick="login.xb.value=1;">男
        <input type="radio" name="radio1" onClick="login.xb.value=2;">保密<input type="hidden" name="xb">
    </td><td>
	    <input type="checkbox" name="boxfunc">包厢
		<input type="checkbox" name="fullscreen">全屏
    </td><td>
		<select name="skin">
			<option style="BACKGROUND:#DDDDFF" value="0">默认颜色</option>
			<option style="BACKGROUND:#749ad2" value="1">方案一</option>
			<option style="BACKGROUND:#6db8c2" value="2">方案二</option>
			<option style="BACKGROUND:#EFD5C9" value="3">方案三</option>
			<option style="BACKGROUND:#c6b193" value="4">方案四</option>
			<option style="BACKGROUND:#D8B8E0" value="5">方案五</option>
			<option style="BACKGROUND:#8ec54c" value="6">方案六</option>
		</select>
    </td>
    
  </tr>
</tbody></table>
<!--********************************************************************************************-->
<table cellspacing="0" cellpadding="3" width="95%" border="1" align="center">
  <tbody><tr align="middle">
	<td><font face="Webdings" color="#000000" size="3">6</font>序号</td>
    <td><font face="Webdings" color="#000000" size="3">6</font>聊天室名称</td>
    <td><font face="Webdings" color="#000000" size="3">6</font>在线人数</td>
    <td><font face="Webdings" color="#000000" size="3">6</font>管理团队</td>
    <td><font face="Webdings" color="#000000" size="3">6</font>当前话题</td>
  </tr>
	<script>
	Server.Sort() ; // 让房间按在线人数多少排序
	var Room = null;
	for(var i = 0; i < Server.RoomsCount(); i ++) // 循环写房间列表
	{
		Room = Server.GetRoomObject(i) ;
		document.write("<TR><TD align=center>") ;

		if(Room.Private == true)
			document.write("[自建]");
		else	
			document.write("<FONT face=Webdings size=3>2</FONT> " + (i+1) ) ; // 房间序号
				
		document.write("</TD>") ;
		document.write("<TD align=left>&nbsp;<a href='javascript:OnLogin(" + i + ");' title=点击房间名称即可进入聊天室>") ;
		if(Room.Title.length > 13)
			document.write(Room.Title.substring(0,10) + "</a><a href='#' onclick='OnClick(\"" + Room.Title + "\")'><font color=black>...</font></a>");
		else
			document.write(Room.Title+"</a>");		//房间名称	
		if(Room.Locked == true)	document.write("[锁]");
		document.write("</TD>");

		document.writeln("<TD align=center><a href='javascript:OnUserList(" + i + ");' title=点击这里可查看在线人员名单>") ;
		document.write(Room.UserCount + "/" + Room.MaxOnline ); //房间人数
		
		if(Room.State == -1)	document.write("(<font color=red>满员</font>)") ; //是否满员
		else if(Room.State == 1)document.write("(<font color=red>热闹<font color=red>)") ;
		
		document.write("</a></TD>") ;

		document.write("<TD align=left>&nbsp;") ; // 管理员名单
		if(Room.AdminNames == "")	document.write("&nbsp;") ;
		if(Room.AdminNames.length > 13) 
			document.write(Room.AdminNames.substring(0,10) + "<a href='#' onclick='OnClick(\"" + Room.AdminNames + "\")'><font color=black>...</font></a>"); // 房间话题
		else
			document.write(Room.AdminNames); // 房间话题

		document.write("</TD>");
		
		document.write("<TD align=left>&nbsp;") ;
		if(Room.Topic.length > 20) 
			document.write(Room.Topic.substring(0,17) + "<a href='#' onclick='OnClick(\"" + Room.Topic + "\")'><font color=black>...</font></a>"); // 房间话题
		else
			document.write(Room.Topic); // 房间话题
		document.writeln("</TD></TR>");
    }/* 修改房间名称显示样式请改此处上页几行 */
	</script><tr><td align="center"><font face="Webdings" size="3">2</font> 1</td><td align="left">&nbsp;<a href="forumchat1.png" title="点击房间名称即可进入聊天室">安全讨论</a></td><td align="center"><a href="forumchat1.png" title="点击这里可查看在线人员名单">
160/161(<font color="red">满员</font>)</a></td><td align="left">&nbsp;admin</td><td align="left">&nbsp;乙烯压缩机故障预测<a href="#" onClick="OnClick(&quot;乙烯压缩机故障预测&quot;)"><font color="black">...</font></a></td></tr>
<tr><td align="center"><font face="Webdings" size="3">2</font> 2</td><td align="left">&nbsp;<a href="forumchat1.png" title="点击房间名称即可进入聊天室">相关通知</a></td><td align="center"><a href="forumchat1.png" title="点击这里可查看在线人员名单">
68/99</a></td><td align="left">&nbsp;admin</td><td align="left">会议通知<a href="#" onClick="OnClick(&quot;会议通知&quot;)"><font color="black">...</font></a></td></tr>
</tbody></table>
<!--********************************************************************************************-->
  <table cellspacing="0" cellpadding="3" width="95%" border="1" align="center">
    <tbody><tr align="center">
      <td>  启动于:<font color="darkblue"> 
        2012-2-7 9:46:38
        </font> 共运行了:<font color="darkblue"> 
        6
        天 
        4
        小时 
        49
        分 
        43
        秒</font> </td>
    </tr>
</tbody></table>
</form>


</body></html>
